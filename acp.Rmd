---
title: "Untitled"
output:
  pdf_document: default
  html_document:
    df_print: paged
date: "2023-02-16"
---




# Objectifs de l'ACP 
L'ACP permet de décrire un jeu de données, de le résumer, d'en réduire la dimensionnalité.
L'ACP réalisée sur les individus du tableau de données répond à différentes questions :

 - Etude des individus (i.e. des athlètes) : deux athlètes sont proches s'ils ont des résultats similaires. On s'intéresse à la variabilité entre individus. Y a-t-il des similarités entre les individus pour toutes les variables ? Peut-on établir des profils d'athlètes ? Peut-on opposer un groupe d'individus à un autre ?
 - Etude des variables (i.e. des performances) : on étudie les liaisons linéaires entre les variables. Les objectifs sont de résumer la matrice des corrélations et de chercher des variables synthétiques: peut-on résumer les performances des athlètes par un petit nombre de variables ?

- Lien entre les deux études : peut-on caractériser des groups d'individus par des variables ?

# Importation des données

```{r}

dat <- read.csv("C:/Users/21650/Desktop/analyse de donnée/Depenses.csv",sep = ",",header = TRUE,row.names=1)
dat

```


# ACP normée avec le package FactoMineR et interprétation de l'ACP.
  
Utilisons maintenant la fonction PCA pour retrouver les résultats obtenus précédemment. 
 
 - On va ajouter deux types de variables comme variables supplémentaires : on ajoute les variables "Rank" and "Points" comme variables continues illustratives et la variable "compétition" comme variable qualitative illustrative.
Les variables illustratives n'influencent pas la construction des composantes principales de l'analyse. 

 - Notons que nous utilisons le package factoextra plutôt que FactoMineR pour la qualité de ces graphiques.
 


```{r}

library(FactoMineR)


summary(dat)
dat

```

```{r}
res.pca=PCA(dat,ncp = 5,graph = F)
head(res.pca$eig) 

```
```{r}

library(ggplot2)
library(factoextra)

fviz_screeplot(res.pca, ncp=10)

 ```
 
  On devrait retenir les 2 premiers axes.
  
## 2. Choix du nombre d'axes à retenir

Trois critères devront être utlisés : taux d'inertie cumulé, critère de Kaiser et critère du coude.

L'objet $\tt eig$ est une matrice à trois colonnes contenants respectivement les valeurs propres de l'ACP, la proportion de variance de chaque composante et les variance cumulées par les composantes principales.   

```{r, echo=TRUE}
head(res.pca$eig)
fviz_screeplot(res.pca, ncp=10)
```


a)	Critère de kaiser : on remarque qu’il y a 4 axes dont les valeurs propres sont supérieures à 1 donc on retient 4 axes d’après ce critère.

b)	Critère du taux d’inertie cumulée :
On remarque que le taux d’inertie cumulé des 2 premiers axes est de 50.09% qui est un taux important compte tenu du fait que nous avons 10 variables : on va donc, d’après ce critère, retenir les 2 premiers axes. 
(Remarquons que retenir 3 axes pour u taux d'inertie de 64.13% est envisageable aussi).
c)	Critère du coude : On remarque que le coude se trouve au niveau du deuxième axe (voir la figure Scree plot), d’après ce critère, on devrait retenir les 2 premiers axes.
 


         
En faisant une sorte de vote des 3 critères on devrait  retenir les 2 premiers axes.






# Interprétation de la carte des variables

```{r, echo=TRUE}



names(res.pca$var)

res.pca$var$coord
  
  res.pca$var$cos2 
``` 
```{r, echo=TRUE}
   
fviz_pca_var(res.pca)

fviz_pca_var(res.pca, col.var="cos2") +
  scale_color_gradient2(low="white", mid="blue", 
                        high="red", midpoint=0.6) + 
  theme_minimal()

```



# Interprétation de la carte des individus

```{r}

ind <- get_pca_ind(res.pca)
ind
```

```{r}

(ind$coord)
```
```{r}

(ind$cos2)
```
```{r}

(ind$contrib)
```
```{r}
fviz_pca_ind(res.pca,geom = "point",col.ind.sup = 'gray')
fviz_pca_ind(res.pca,geom = "text",col.ind.sup = 'gray')
```
```{r}

fviz_pca_ind(res.pca,geom = "text",col.ind="cos2")+
scale_color_gradient2(low="blue", mid="white", 
                      high="red", midpoint=0.5)
```
```{r}

plot.PCA(res.pca, axes=c(1, 2), choix="ind", cex=0.7)

```
